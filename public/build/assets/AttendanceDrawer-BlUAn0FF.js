import{r as m,W as E,j as e}from"./app-C8aSnOsC.js";import{D as p,a as S,b as D,B as F}from"./ToggleSwitch-BZs51KRg.js";import{I as c}from"./InputError-VcDgzKKy.js";import{C as I}from"./CustomDatepicker-98gPMxCH.js";function B({isOpen:j,onClose:h,attendance:i=null,employees:_,clients:d}){const l=i!==null,[n,x]=m.useState(null);m.useState(new Date);const{data:s,setData:t,errors:r,post:v,put:y,processing:b,reset:g}=E({date:"",daily_value:"",employee_id:"",client_id:"",city_id:""});m.useEffect(()=>{i&&l&&(t({date:i.date||"",daily_value:i.daily_value||"",employee_id:i.employee.id||"",client_id:i.client.id||"",city_id:i.city.id||""}),x(d.data.find(a=>a.id===i.client.id)))},[i,d]);const f=a=>{a.preventDefault();const o=l?y:v,u=l?route("attendances.update",i.id):route("attendances.store");o(u,{onSuccess:()=>{h(),g()},onError:C=>{console.error("Error handling attendance: ",C)}})},N=a=>{const o=d.data.find(u=>u.id===parseInt(a.target.value,10));x(o),t({...s,city_id:"",client_id:a.target.value})};return e.jsxs(p,{open:j,onClose:h,position:"right",children:[e.jsx(p.Header,{title:l?"Editar asistencia":"Agregar asistencia",titleIcon:l?S:D}),e.jsx(p.Items,{children:e.jsxs("form",{onSubmit:f,children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"date",className:"label",children:"Fecha"}),e.jsx(I,{value:s.date,onChange:a=>t("date",a),disabled:l,id:"date"}),e.jsx(c,{message:r.date})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"employee_id",className:"label",children:"Empleado"}),e.jsxs("select",{id:"employee_id",value:s.employee_id,onChange:a=>t("employee_id",a.target.value),className:"input",children:[e.jsx("option",{value:"",disabled:!0,children:"Selecciona el usuario..."}),_.data.map(a=>e.jsx("option",{value:a.id,children:a.first_name+" "+a.last_name},a.id))]}),e.jsx(c,{message:r.employee_id})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"client_id",className:"label",children:"Operación"}),e.jsxs("select",{id:"client_id",value:s.client_id,onChange:N,className:"input",children:[e.jsx("option",{value:"",disabled:!0,children:"Selecciona el cliente..."}),d.data.map(a=>e.jsx("option",{value:a.id,children:a.company_name},a.id))]}),e.jsx(c,{message:r.client_id})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"city_id",className:"label",children:"Ciudad de la Operación"}),e.jsxs("select",{id:"city_id",value:s.city_id,onChange:a=>t("city_id",a.target.value),disabled:!n,className:"input",children:[e.jsx("option",{value:"",disabled:!0,children:"Selecciona la ciudad..."}),n==null?void 0:n.cities.map(a=>e.jsx("option",{value:a.id,children:a.city_name},a.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"daily_value",className:"label",children:"Valor del Día"}),e.jsx("input",{type:"text",id:"daily_value",value:s.daily_value,onChange:a=>t("daily_value",a.target.value),className:"input"}),e.jsx(c,{message:r.daily_value})]})]}),e.jsx(F,{type:"submit",disabled:b,color:"blue",className:"mt-4 w-full text-base font-medium",children:l?"Actualizar asistencia":"Guardar asistencia"})]})})]})}export{B as default};
