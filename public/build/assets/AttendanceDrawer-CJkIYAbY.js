import{r as u,W as S,j as e}from"./app-CTCa4fs-.js";import{D as m,a as C,b as D,B as F}from"./ToggleSwitch-DvtBiXHV.js";import{I as p}from"./InputError-T7M75z13.js";import{C as I}from"./CustomDatepicker-D_Zo68B2.js";function B({isOpen:j,onClose:h,attendance:a=null,employees:_,clients:d}){const l=a!==null,[r,x]=u.useState(null);u.useState(new Date);const{data:s,setData:t,errors:n,post:v,put:b,processing:g,reset:y}=S({date:"",daily_value:"",employee_id:"",client_id:"",city_id:""});u.useEffect(()=>{a&&l&&(t({date:a.date||"",daily_value:a.daily_value||"",employee_id:a.employee.id||"",client_id:a.client.id||"",city_id:a.city.id||""}),x(d.data.find(i=>i.id===a.client.id)))},[a,d]);const f=i=>{i.preventDefault();const c=l?b:v,o=l?route("attendances.update",a.id):route("attendances.store");c(o,{onSuccess:()=>{h(),y()},onError:E=>{console.error("Error handling attendance: ",E)}})},N=i=>{const c=d.data.find(o=>o.id===parseInt(i.target.value,10));x(c),t({...s,city_id:"",client_id:i.target.value})};return e.jsxs(m,{open:j,onClose:h,position:"right",children:[e.jsx(m.Header,{title:l?"Editar asistencia":"Agregar asistencia",titleIcon:l?C:D}),e.jsx(m.Items,{children:e.jsxs("form",{onSubmit:f,children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"date",className:"label",children:"Fecha"}),e.jsx(I,{value:s.date,onChange:i=>t("date",i),disabled:l,id:"date"}),e.jsx(p,{message:n.date})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"employee_id",className:"label",children:"Empleado"}),e.jsxs("select",{id:"employee_id",value:s.employee_id,onChange:i=>t("employee_id",i.target.value),className:"input",children:[e.jsx("option",{value:"",disabled:!0,children:"Selecciona el usuario..."}),_.data.map(i=>e.jsx("option",{value:i.id,children:i.first_name+" "+i.last_name},i.id))]}),e.jsx(p,{message:n.employee_id})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"client_id",className:"label",children:"Operación"}),e.jsxs("select",{id:"client_id",value:s.client_id,onChange:N,className:"input",children:[e.jsx("option",{value:"",disabled:!0,children:"Selecciona el cliente..."}),d.data.map(i=>e.jsx("option",{value:i.id,children:i.company_name},i.id))]}),e.jsx(p,{message:n.client_id})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"city_id",className:"label",children:"Ciudad de la Operación"}),e.jsxs("select",{id:"city_id",value:s.city_id,onChange:i=>t("city_id",i.target.value),disabled:!r,className:"input",children:[e.jsx("option",{value:"",disabled:!0,children:"Selecciona la ciudad..."}),r==null?void 0:r.cities.map(i=>e.jsx("option",{value:i.id,children:i.city_name},i.id))]})]})]}),e.jsx(F,{type:"submit",disabled:g,color:"blue",className:"mt-4 w-full text-base font-medium",children:l?"Actualizar asistencia":"Guardar asistencia"})]})})]})}export{B as default};
